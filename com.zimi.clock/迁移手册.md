## è¿ç§»æ‰‹å†Œ

1. è°ƒæ•´ç›®å½•ç»“æ„ï¼Œæ ¹ç›®å½•å¢åŠ `index.js`å’Œ`index.ios.js`ã€‚

2. åŸæœ‰çš„`Main/index.ios.js`æ›´åä¸º`Main/index.js`ï¼Œåˆ æ‰å…¶ä¸­æ³¨å†Œappå…¥å£çš„ä¸€è¡Œï¼š`AppRegistry.registerComponent()`ã€‚

3. å®‰è£…æ’ä»¶ä½¿ç”¨çš„ç¬¬ä¸‰æ–¹åº“ï¼ˆæ¡†æ¶`package.json`ä¸­æœªåŒ…å«ï¼‰ã€‚æ¯”å¦‚é—¹é’Ÿä½¿ç”¨åˆ°çš„`react-native-swipeout`ã€‚

4. å¼•ç”¨ä¾èµ–å°½é‡ä½¿ç”¨es6çš„`import`ï¼Œè€Œä¸æ˜¯`require`ã€‚

5. æ–°æ¡†æ¶è°ƒæ•´äº†`ImageButton`ï¼Œé€‚ç”¨äºä¸¤ä¸ªå¹³å°ã€‚

   ```js
   // old
   var ImageButton = require('../CommonModules/ImageButton');
   
   // new
   import ImageButton from 'miot/ui/ImageButton';
   ```

6. RN54åºŸå¼ƒäº†`react-native`ä¸­çš„`Component`ï¼Œæ‰€æœ‰ç»„ä»¶å°†ç»§æ‰¿`react`çš„`Component`ã€‚

   ```js
   // old
   var React = require('react-native');
   var {
     StyleSheet,
     Text,
     DeviceEventEmitter,
     PixelRatio,
   } = React;
   
   // new
   import React from 'react';
   import {
     StyleSheet,
     Text,
     DeviceEventEmitter,
     PixelRatio,
   } from 'react-native';
   ```

7. RN54å°†`PropTypes`ä»`react-native`ä¸­æŠ½ç¦»å‡ºæ¥ï¼Œç‹¬ç«‹æˆ`prop-types`ã€‚

   ```js
   // old
   var propTypes = {
     source: React.PropTypes.object,
     highlightedSource: React.PropTypes.object,
     onPress: React.PropTypes.func,
   };
   
   // new
   import PropTypes from 'prop-types';
   // ...
   var propTypes = {
     source: PropTypes.object,
     highlightedSource: PropTypes.object,
     onPress: PropTypes.func,
   };
   ```

8. **åˆ‡æ¢è·¯ç”±æ¡†æ¶ï¼ˆâ—ï¸ï¼‰**

   - æ‰€æœ‰é¡µé¢åˆ é™¤ä¹‹å‰çš„è·¯ç”±ç›¸å…³ä»£ç ï¼š

     ```js
     // old
     class MyComponent extends React.Component {
     	// ...
     }
     
     // ...
     
     var route = {
       title: xxx,
       component: MyComponent,
       navBarStyle: {
         backgroundColor: '#f2f2f2',
       },
     };
     
     module.exports = {
       component: MyComponent,
       route: route,
     }
     
     // new
     export default class MyComponent extends React.Component {
     	// ...
     }
     
     // ...
     
     // æ‘ˆå¼ƒä¹‹å‰çš„è·¯ç”±ç³»ç»Ÿå†™æ³•
     // var route = {
     //  title: xxx,
     //  component: MyComponent,
     //  navBarStyle: {
     //    backgroundColor: '#f2f2f2',
     //  },
     //};
     
     // module.exports = {
     //  component: MyComponent,
     //  route: route,
     // }
     ```

   - åœ¨å…¥å£æ–‡ä»¶`Main/index.js`ä¸­é›†ä¸­ç®¡ç†æ‰€æœ‰çš„é¡µé¢ï¼Œå¢åŠ ä»¥ä¸‹ä»£ç ï¼š

     ```js
     // å¯¼èˆªç›¸å…³ç»„ä»¶
     import { createStackNavigator } from 'react-navigation';
     import { TitleBarBlack } from 'miot/ui';
     import CardStackStyleInterpolator from 'react-navigation/src/views/StackView/StackViewStyleInterpolator';
     // å¯¼å…¥æ‰€æœ‰çš„é¡µé¢
     import SceneMain from './SceneMain';
     import MainPage from './MainPage';
     import MHSetting from './MHSetting';
     // ...
     
     const RootStack = createStackNavigator(
       {
         // ...
         SceneMain: SceneMain,
         MainPage: MainPage,
         MHSetting: MHSetting,
         // ...
       },
       {
         initialRouteName: 'MainPage',
         navigationOptions: ({ navigation }) => {
           return {
             header: <TitleBarBlack title={navigation.state.params ? navigation.state.params.title : ''} style={{ backgroundColor: '#fff' }}
               onPressLeft={() => {
                 navigation.goBack();
               }} />,
           };
         },
         transitionConfig: () => ({
           screenInterpolator: CardStackStyleInterpolator.forHorizontal,
         }),
       }
     );
     ```

   - é¡µé¢è·³è½¬ï¼ŒåŒ…æ‹¬å‚æ•°ä¼ é€’å’Œå‚æ•°è·å–

     ```js
     // old
     this.props.navigator.push({
       // è·³è½¬é¡µé¢
       route,
       // ä¼ å‚ï¼Œåœ¨è·³è½¬é¡µé¢ä¸­å¯é€šè¿‡propsç›´æ¥è®¿é—®ï¼Œå³ï¼šthis.props.key
       passProps: {
         key: value
       },
     });
     
     // new
     this.props.navigation.navigate('ComponentName', {
       key: value
     });
     // åœ¨è·³è½¬é¡µé¢è·å–å‚æ•°
     // method 1
     this.props.navigation.state.params.key
     // method 2
     this.props.navigation.getParam("key");
     ```

   - è¿”å›ä¸Šçº§é¡µé¢

   - ```js
     // old
     this.props.navigator.pop();
     
     // new
     this.props.navigation.goback();
     ```

   - é€€å‡ºæ’ä»¶

   - ```js
     // old
     MHPluginSDK.closeCurrentPage();
     
     // new
     import { Package } from "miot";
     Package.exit()
     ```

9. æ–°è·¯ç”±æ¡†æ¶çš„å…¶ä»–ä½¿ç”¨æŠ€å·§

  - é¡µé¢è‡ªå®šä¹‰å¯¼èˆªæ 

    ```js
    // æ‰€æœ‰é¡µé¢é»˜è®¤æ²¿ç”¨index.jsä¸­RootStackå®šä¹‰çš„å¯¼èˆªæ æ ·å¼
    const RootStack = createStackNavigator(
    ...
        navigationOptions: ({ navigation }) => {
          return {
            header:
              <TitleBarBlack
                title={navigation.state.params ? navigation.state.params.title : ''}
                style={{ backgroundColor: '#fff' }}
                onPressLeft={() => { navigation.goBack() }}
              />,
          };
        },
    ...
    );
    
    // è‡ªå®šä¹‰å¯¼èˆªæ æ ·å¼
    export default class AddReminder extends React.Component {
      // è¡¨ç¤ºä¸ä½¿ç”¨é»˜è®¤çš„å¯¼èˆªæ 
      static navigationOptions = ({ navigation }) => {
        return {
          header: null
        };
      };
      
      //...
    
      render() {
        return (
            // è‡ªå®šä¹‰æ ‡é¢˜çš„æ ·å¼å’Œé¢œè‰²ï¼Œå·¦å³æŒ‰é’®çš„æ ·å¼ã€é¢œè‰²ä»¥åŠç»‘å®šäº‹ä»¶
            <TitleBarBlack
              title="newTitle" style={{ backgroundColor: 'red' }}
              onPressLeft={() => { this.props.navigation.goBack() }}
              rightText="save"
              leftText="cancel"
              onPressRight={() => {
                this._save();
              }}
            />
          //...
        )
      }
    ```

  - ç›‘å¬å¯¼èˆªæ çš„ç”Ÿå‘½å‘¨æœŸ

    ```js
    // old
    // å¯ç›‘å¬'willfocus'å’Œ'didfocus'
    this._didFocusListener = DeviceEventEmitter.addListener('didfocus', ({route}) => {
      console.log(route);
    }
    
    // new
    // å¯ç›‘å¬'willBlur', 'willFocus', 'didFocus', 'didBlur'
    this._didFocusListener = this.props.navigation.addListener('didFocus', payload => {
      console.log(payload);
    }
    ```

  - å¯¼èˆªæ æ›´æ–°æœºåˆ¶

    ```js
      // Eg. change device name
      static navigationOptions = ({ navigation }) => {
        return {
          header:
            <TitleBarBlack
              title={navigation.state["params"] ? navigation.state.params.name : Device.name}
              style={{ backgroundColor: '#fff' }}
              onPressLeft={() => { Package.exit() }}
              onPressRight={() => {
                navigation.navigate('MHSetting', { 'title': 'è®¾ç½®' });
              }}
            />
        };
      };
    
      // è®¾ç½®ä¸­æ”¹åä¹‹åï¼Œé¦–é¡µtitleåŒæ­¥æ”¹å
      this._deviceNameChangedListener = DeviceEvent.deviceNameChanged.addListener((device) => {
        this.props.navigation.setParams({
          name: device.name
        });
        this.forceUpdate();
      });
    ```

10. ç»„ä»¶ç›¸å…³

  - `Image`ä¸å†å…è®¸åµŒå¥—

    ```jsx
    // old
    <Image>
      <Text></Text>
    </Image>
    // old,âœ…
    <Animated.Image>
      <Animated.Text></Animated.Text>
    </Animated.Image>
    
    // new
    <ImageBackground>
      <Text></Text>
    </ImageBackground>
    // not allowed,âŒ
    <Animated.ImageBackground>
      <Animated.Text></Animated.Text>
    </Animated.ImageBackground>
    // alternative solution,ğŸ‘Œ
    <Animated.ImageBackground />
    <Animated.View style={{position:'absolute'}}>
      <Animated.Text></Animated.Text>
    </Animated.View>
    ```

  - `SwitchIOS`åºŸå¼ƒ

    ```jsx
    // old
    <SwitchIOS>
    </SwitchIOS>
    
    // new
    // cross-platform solution
    import { RkSwitch } from 'react-native-ui-kitten';
    <RkSwitch>
    </RkSwitch>
    ```

  - `DatePicker`è·¨å¹³å°è§£å†³æ–¹æ¡ˆ

    ```jsx
    // old
    import {DatePickerIOS} from 'react-native'
    
    <DatePickerIOS
    ```

    

11. å›¾ç‰‡ä»¥åŠå…¶ä»–èµ„æºçš„å¼•ç”¨æ–¹å¼

    ```js
    // old
    <Image
    source={{ uri: MHPluginSDK.basePath + imagePath + imageName }}
    style={{ width: x, height: y }}
    />
    <Image 
    style={styles.icon} 
    source={this.props.app.sourceOfImage(imageName)}
    />
    
    // new
    // static image
    <Image
    source={require(relativeImagePath + imageName)}
    style={{ width: x, height: y }}
    />
    // dynamic image
    <Image
    source={{uri: uri}} // remote url or local absolute path
    style={{ width: x, height: y }}
    />
    ```

12. æ–°çš„å¤šè¯­è¨€è§£å†³æ–¹æ¡ˆ

13. `React.createClass`æŠ¥é”™è§£å†³æ–¹æ¡ˆ

14. `setState`çš„æ­£ç¡®ç”¨æ³•

15. æ›´æ–°å¯¼èˆªæ çš„æ ·å¼å’Œæ–‡æ¡ˆ

16. è®¾å¤‡çŠ¶æ€è®¢é˜…
