<a name="module_miot/Bluetooth"></a>

## miot/Bluetooth
蓝牙设备操作类

**Export**:   
**Example**  
```js
import {Device} from 'miot'

const ble = Device.getBluetoothLE();
ble.connect().then(ble=>{

 ble.startDiscoverServices("a-b-c-d-e", ...)
  ...
});

...
ble.getService("a-b-c-d-e").startDiscoverCharacteristics("1-2-3-4-5",...)

...
const charac = ble.getService('...').getCharacteristic('...')
charac.setNotify().then(characteristic=>{}).catch(err=>{});
charac.read().then(characteristic=>{characteristic.value ... }).catch(err=>{});
charac.write().then(characteristic=>{}).catch(err=>{})

...

ble.disconnect()
```

* [miot/Bluetooth](#module_miot/Bluetooth)
    * [module.exports](#exp_module_miot/Bluetooth--module.exports) ⏏
        * _static_
            * [.IBluetoothCharacteristic](#module_miot/Bluetooth--module.exports.IBluetoothCharacteristic)
                * [.isDiscovered](#module_miot/Bluetooth--module.exports.IBluetoothCharacteristic+isDiscovered) : <code>boolean</code>
                * [.isValueLoaded](#module_miot/Bluetooth--module.exports.IBluetoothCharacteristic+isValueLoaded) : <code>boolean</code>
                * [.UUID](#module_miot/Bluetooth--module.exports.IBluetoothCharacteristic+UUID) : <code>string</code>
                * [.value](#module_miot/Bluetooth--module.exports.IBluetoothCharacteristic+value) : <code>\*</code>
                * [.read()](#module_miot/Bluetooth--module.exports.IBluetoothCharacteristic+read) ⇒ <code>Promise.&lt;IBluetoothCharacteristic&gt;</code>
                * [.write(value)](#module_miot/Bluetooth--module.exports.IBluetoothCharacteristic+write) ⇒ <code>Promise.&lt;IBluetoothCharacteristic&gt;</code>
                * [.writeWithoutResponse(value)](#module_miot/Bluetooth--module.exports.IBluetoothCharacteristic+writeWithoutResponse) ⇒ <code>Promise.&lt;IBluetoothCharacteristic&gt;</code>
                * [.setNotify(flag)](#module_miot/Bluetooth--module.exports.IBluetoothCharacteristic+setNotify) ⇒ <code>Promise.&lt;IBluetoothCharacteristic&gt;</code>
            * [.IBluetoothService](#module_miot/Bluetooth--module.exports.IBluetoothService)
                * [.UUID](#module_miot/Bluetooth--module.exports.IBluetoothService+UUID) : <code>string</code>
                * [.isDiscovered](#module_miot/Bluetooth--module.exports.IBluetoothService+isDiscovered) : <code>boolean</code>
                * [.getCharacteristic](#module_miot/Bluetooth--module.exports.IBluetoothService+getCharacteristic) ⇒ <code>IBluetoothCharacteristic</code>
                * [.startDiscoverCharacteristics(...characteristicUUIDs)](#module_miot/Bluetooth--module.exports.IBluetoothService+startDiscoverCharacteristics) ⇒ <code>boolean</code>
            * [.IBluetoothLock](#module_miot/Bluetooth--module.exports.IBluetoothLock)
                * [.toggle(cmd, timeout)](#module_miot/Bluetooth--module.exports.IBluetoothLock+toggle) ⇒ <code>Promise.&lt;IBluetoothLock&gt;</code>
                * [.isShareKeyValid()](#module_miot/Bluetooth--module.exports.IBluetoothLock+isShareKeyValid) ⇒ <code>Promise.&lt;IBluetoothLock&gt;</code>
                * [.getOneTimePassword(interval, digits)](#module_miot/Bluetooth--module.exports.IBluetoothLock+getOneTimePassword) ⇒ <code>Promise.&lt;Array.&lt;int&gt;&gt;</code>
                * [.encryptMessage(message)](#module_miot/Bluetooth--module.exports.IBluetoothLock+encryptMessage) ⇒ <code>Promise.&lt;string&gt;</code>
                * [.decryptMessage(encrypted)](#module_miot/Bluetooth--module.exports.IBluetoothLock+decryptMessage) ⇒ <code>Promise.&lt;string&gt;</code>
            * [.IBluetooth](#module_miot/Bluetooth--module.exports.IBluetooth)
                * [.isBLE](#module_miot/Bluetooth--module.exports.IBluetooth+isBLE) : <code>boolean</code>
                * [.mac](#module_miot/Bluetooth--module.exports.IBluetooth+mac) : <code>string</code>
                * [.UUID](#module_miot/Bluetooth--module.exports.IBluetooth+UUID) : <code>string</code>
                * [.isConnected](#module_miot/Bluetooth--module.exports.IBluetooth+isConnected) : <code>boolean</code>
                * [.connect(type, option)](#module_miot/Bluetooth--module.exports.IBluetooth+connect) ⇒ <code>Promise.&lt;IBluetooth&gt;</code>
                * [.readRSSI()](#module_miot/Bluetooth--module.exports.IBluetooth+readRSSI) ⇒ <code>Promise.&lt;\*&gt;</code>
                * [.disconnect(delay)](#module_miot/Bluetooth--module.exports.IBluetooth+disconnect)
                * [.maximumWriteValueLength(type)](#module_miot/Bluetooth--module.exports.IBluetooth+maximumWriteValueLength)
                * [.getVersion()](#module_miot/Bluetooth--module.exports.IBluetooth+getVersion) ⇒ <code>Promise.&lt;any&gt;</code>
            * [.IBluetoothLE](#module_miot/Bluetooth--module.exports.IBluetoothLE)
                * [.securityLock](#module_miot/Bluetooth--module.exports.IBluetoothLE+securityLock) ⇒ <code>IBluetoothLock</code>
                * [.getService](#module_miot/Bluetooth--module.exports.IBluetoothLE+getService) ⇒ <code>IBluetoothService</code>
                * [.startDiscoverServices(...serviceUUIDs)](#module_miot/Bluetooth--module.exports.IBluetoothLE+startDiscoverServices) ⇒ <code>boolean</code>
                * [.getVersion()](#module_miot/Bluetooth--module.exports.IBluetoothLE+getVersion) ⇒ <code>boolean</code>
            * [.IBluetoothClassic](#module_miot/Bluetooth--module.exports.IBluetoothClassic)
            * [.UUID128](#module_miot/Bluetooth--module.exports.UUID128) ⇒ <code>string</code>
            * [.isSameUUID(uuid1, uuid2)](#module_miot/Bluetooth--module.exports.isSameUUID)
            * [.createBluetoothLE(macOrPeripheralID)](#module_miot/Bluetooth--module.exports.createBluetoothLE) ⇒ <code>IBluetoothLE</code>
            * [.createBluetoothClassic(macOrPeripheralID)](#module_miot/Bluetooth--module.exports.createBluetoothClassic) ⇒ <code>IBluetoothClassic</code>
            * [.checkBluetoothIsEnabled()](#module_miot/Bluetooth--module.exports.checkBluetoothIsEnabled) ⇒ <code>Promise.&lt;boolean&gt;</code>
            * [.startScan(durationInMillis, ...serviceUUIDs)](#module_miot/Bluetooth--module.exports.startScan) ⇒ <code>void</code>
            * [.stopScan()](#module_miot/Bluetooth--module.exports.stopScan) ⇒ <code>void</code>
            * [.retrievePeripheralsForIOS(...UUIDs)](#module_miot/Bluetooth--module.exports.retrievePeripheralsForIOS) ⇒ <code>Promise.&lt;Map.&lt;uuid, Bluetooth&gt;&gt;</code>
            * [.retrievePeripheralsWithServicesForIOS(...serviceUUIDs)](#module_miot/Bluetooth--module.exports.retrievePeripheralsWithServicesForIOS) ⇒ <code>Promise.&lt;Map.&lt;uuid, Bluetooth&gt;&gt;</code>
            * [.enableBluetoothForAndroid(silence)](#module_miot/Bluetooth--module.exports.enableBluetoothForAndroid) ⇒
            * [.isBleGatewayConnected(mac)](#module_miot/Bluetooth--module.exports.isBleGatewayConnected) ⇒ <code>Promise.&lt;boolean&gt;</code>
            * [.bindDeviceforMIUI(mac)](#module_miot/Bluetooth--module.exports.bindDeviceforMIUI)
            * [.unBindDeviceforMIUI(mac)](#module_miot/Bluetooth--module.exports.unBindDeviceforMIUI)
            * [.setAlertConfigsOnMIUI(alert, enable, mac)](#module_miot/Bluetooth--module.exports.setAlertConfigsOnMIUI)
        * _inner_
            * [~BluetoothEvent](#module_miot/Bluetooth--module.exports..BluetoothEvent) : <code>object</code>
                * ["bluetoothConnectionStatusChanged" (bluetooh, isConnected)](#module_miot/Bluetooth--module.exports..BluetoothEvent.event_bluetoothConnectionStatusChanged)
                * ["bluetoothDeviceDiscovered" (bluetoohData)](#module_miot/Bluetooth--module.exports..BluetoothEvent.event_bluetoothDeviceDiscovered)
                * ["bluetoothDeviceDiscoverFailed" (error)](#module_miot/Bluetooth--module.exports..BluetoothEvent.event_bluetoothDeviceDiscoverFailed)
                * ["bluetoothSeviceDiscovered" (bluetooh, ...service)](#module_miot/Bluetooth--module.exports..BluetoothEvent.event_bluetoothSeviceDiscovered)
                * ["bluetoothSeviceDiscoverFailed" (bluetooh, error)](#module_miot/Bluetooth--module.exports..BluetoothEvent.event_bluetoothSeviceDiscoverFailed)
                * ["bluetoothCharacteristicDiscovered" (bluetooh, service, ...characters)](#module_miot/Bluetooth--module.exports..BluetoothEvent.event_bluetoothCharacteristicDiscovered)
                * ["bluetoothCharacteristicDiscoverFailed" (bluetooh, service, error)](#module_miot/Bluetooth--module.exports..BluetoothEvent.event_bluetoothCharacteristicDiscoverFailed)
                * ["bluetoothCharacteristicValueChanged" (bluetooh, service, character, value)](#module_miot/Bluetooth--module.exports..BluetoothEvent.event_bluetoothCharacteristicValueChanged)
                * ["bluetoothStatusChanged" (isEnabled)](#module_miot/Bluetooth--module.exports..BluetoothEvent.event_bluetoothStatusChanged)

<a name="exp_module_miot/Bluetooth--module.exports"></a>

### module.exports ⏏
**Kind**: Exported member  
**Export**:   
<a name="module_miot/Bluetooth--module.exports.IBluetoothCharacteristic"></a>

#### module.exports.IBluetoothCharacteristic
**Kind**: static interface of [<code>module.exports</code>](#exp_module_miot/Bluetooth--module.exports)  

* [.IBluetoothCharacteristic](#module_miot/Bluetooth--module.exports.IBluetoothCharacteristic)
    * [.isDiscovered](#module_miot/Bluetooth--module.exports.IBluetoothCharacteristic+isDiscovered) : <code>boolean</code>
    * [.isValueLoaded](#module_miot/Bluetooth--module.exports.IBluetoothCharacteristic+isValueLoaded) : <code>boolean</code>
    * [.UUID](#module_miot/Bluetooth--module.exports.IBluetoothCharacteristic+UUID) : <code>string</code>
    * [.value](#module_miot/Bluetooth--module.exports.IBluetoothCharacteristic+value) : <code>\*</code>
    * [.read()](#module_miot/Bluetooth--module.exports.IBluetoothCharacteristic+read) ⇒ <code>Promise.&lt;IBluetoothCharacteristic&gt;</code>
    * [.write(value)](#module_miot/Bluetooth--module.exports.IBluetoothCharacteristic+write) ⇒ <code>Promise.&lt;IBluetoothCharacteristic&gt;</code>
    * [.writeWithoutResponse(value)](#module_miot/Bluetooth--module.exports.IBluetoothCharacteristic+writeWithoutResponse) ⇒ <code>Promise.&lt;IBluetoothCharacteristic&gt;</code>
    * [.setNotify(flag)](#module_miot/Bluetooth--module.exports.IBluetoothCharacteristic+setNotify) ⇒ <code>Promise.&lt;IBluetoothCharacteristic&gt;</code>

<a name="module_miot/Bluetooth--module.exports.IBluetoothCharacteristic+isDiscovered"></a>

##### iBluetoothCharacteristic.isDiscovered : <code>boolean</code>
是否已经被发现

**Kind**: instance property of [<code>IBluetoothCharacteristic</code>](#module_miot/Bluetooth--module.exports.IBluetoothCharacteristic)  
**Read only**: true  
<a name="module_miot/Bluetooth--module.exports.IBluetoothCharacteristic+isValueLoaded"></a>

##### iBluetoothCharacteristic.isValueLoaded : <code>boolean</code>
数值是否已经加载, 为 true 时,本类才能读到正确的 value

**Kind**: instance property of [<code>IBluetoothCharacteristic</code>](#module_miot/Bluetooth--module.exports.IBluetoothCharacteristic)  
**Read only**: true  
<a name="module_miot/Bluetooth--module.exports.IBluetoothCharacteristic+UUID"></a>

##### iBluetoothCharacteristic.UUID : <code>string</code>
特征值的 UUID

**Kind**: instance property of [<code>IBluetoothCharacteristic</code>](#module_miot/Bluetooth--module.exports.IBluetoothCharacteristic)  
**Read only**: true  
<a name="module_miot/Bluetooth--module.exports.IBluetoothCharacteristic+value"></a>

##### iBluetoothCharacteristic.value : <code>\*</code>
数值, 配合 isValueLoaded 使用

**Kind**: instance property of [<code>IBluetoothCharacteristic</code>](#module_miot/Bluetooth--module.exports.IBluetoothCharacteristic)  
**Read only**: true  
**Example**  
```js
...
  if(charateristic.isValueLoaded){
      const val = characteristic.value;
      ...
  }
  ...
```
<a name="module_miot/Bluetooth--module.exports.IBluetoothCharacteristic+read"></a>

##### iBluetoothCharacteristic.read() ⇒ <code>Promise.&lt;IBluetoothCharacteristic&gt;</code>
读取蓝牙数据

**Kind**: instance method of [<code>IBluetoothCharacteristic</code>](#module_miot/Bluetooth--module.exports.IBluetoothCharacteristic)  
<a name="module_miot/Bluetooth--module.exports.IBluetoothCharacteristic+write"></a>

##### iBluetoothCharacteristic.write(value) ⇒ <code>Promise.&lt;IBluetoothCharacteristic&gt;</code>
写数据
对应 writeWithResponse

**Kind**: instance method of [<code>IBluetoothCharacteristic</code>](#module_miot/Bluetooth--module.exports.IBluetoothCharacteristic)  

| Param | Type |
| --- | --- |
| value | <code>\*</code> | 

<a name="module_miot/Bluetooth--module.exports.IBluetoothCharacteristic+writeWithoutResponse"></a>

##### iBluetoothCharacteristic.writeWithoutResponse(value) ⇒ <code>Promise.&lt;IBluetoothCharacteristic&gt;</code>
直接写数据
对应 writeWithoutResponse

**Kind**: instance method of [<code>IBluetoothCharacteristic</code>](#module_miot/Bluetooth--module.exports.IBluetoothCharacteristic)  

| Param | Type |
| --- | --- |
| value | <code>\*</code> | 

<a name="module_miot/Bluetooth--module.exports.IBluetoothCharacteristic+setNotify"></a>

##### iBluetoothCharacteristic.setNotify(flag) ⇒ <code>Promise.&lt;IBluetoothCharacteristic&gt;</code>
设置数值变化监听开关

**Kind**: instance method of [<code>IBluetoothCharacteristic</code>](#module_miot/Bluetooth--module.exports.IBluetoothCharacteristic)  

| Param | Type | Description |
| --- | --- | --- |
| flag | <code>boolean</code> | true 打开监听, false 则关闭监听 |

<a name="module_miot/Bluetooth--module.exports.IBluetoothService"></a>

#### module.exports.IBluetoothService
**Kind**: static interface of [<code>module.exports</code>](#exp_module_miot/Bluetooth--module.exports)  

* [.IBluetoothService](#module_miot/Bluetooth--module.exports.IBluetoothService)
    * [.UUID](#module_miot/Bluetooth--module.exports.IBluetoothService+UUID) : <code>string</code>
    * [.isDiscovered](#module_miot/Bluetooth--module.exports.IBluetoothService+isDiscovered) : <code>boolean</code>
    * [.getCharacteristic](#module_miot/Bluetooth--module.exports.IBluetoothService+getCharacteristic) ⇒ <code>IBluetoothCharacteristic</code>
    * [.startDiscoverCharacteristics(...characteristicUUIDs)](#module_miot/Bluetooth--module.exports.IBluetoothService+startDiscoverCharacteristics) ⇒ <code>boolean</code>

<a name="module_miot/Bluetooth--module.exports.IBluetoothService+UUID"></a>

##### iBluetoothService.UUID : <code>string</code>
蓝牙服务 UUID

**Kind**: instance property of [<code>IBluetoothService</code>](#module_miot/Bluetooth--module.exports.IBluetoothService)  
**Read only**: true  
<a name="module_miot/Bluetooth--module.exports.IBluetoothService+isDiscovered"></a>

##### iBluetoothService.isDiscovered : <code>boolean</code>
蓝牙服务是否已被发现

**Kind**: instance property of [<code>IBluetoothService</code>](#module_miot/Bluetooth--module.exports.IBluetoothService)  
**Read only**: true  
<a name="module_miot/Bluetooth--module.exports.IBluetoothService+getCharacteristic"></a>

##### iBluetoothService.getCharacteristic ⇒ <code>IBluetoothCharacteristic</code>
获取蓝牙特征

**Kind**: instance property of [<code>IBluetoothService</code>](#module_miot/Bluetooth--module.exports.IBluetoothService)  

| Param | Type |
| --- | --- |
| characteristicUUID | <code>string</code> | 

<a name="module_miot/Bluetooth--module.exports.IBluetoothService+startDiscoverCharacteristics"></a>

##### iBluetoothService.startDiscoverCharacteristics(...characteristicUUIDs) ⇒ <code>boolean</code>
发现蓝牙特征

**Kind**: instance method of [<code>IBluetoothService</code>](#module_miot/Bluetooth--module.exports.IBluetoothService)  

| Param | Type | Description |
| --- | --- | --- |
| ...characteristicUUIDs | <code>string</code> | 特征的 UUID |

<a name="module_miot/Bluetooth--module.exports.IBluetoothLock"></a>

#### module.exports.IBluetoothLock
**Kind**: static interface of [<code>module.exports</code>](#exp_module_miot/Bluetooth--module.exports)  

* [.IBluetoothLock](#module_miot/Bluetooth--module.exports.IBluetoothLock)
    * [.toggle(cmd, timeout)](#module_miot/Bluetooth--module.exports.IBluetoothLock+toggle) ⇒ <code>Promise.&lt;IBluetoothLock&gt;</code>
    * [.isShareKeyValid()](#module_miot/Bluetooth--module.exports.IBluetoothLock+isShareKeyValid) ⇒ <code>Promise.&lt;IBluetoothLock&gt;</code>
    * [.getOneTimePassword(interval, digits)](#module_miot/Bluetooth--module.exports.IBluetoothLock+getOneTimePassword) ⇒ <code>Promise.&lt;Array.&lt;int&gt;&gt;</code>
    * [.encryptMessage(message)](#module_miot/Bluetooth--module.exports.IBluetoothLock+encryptMessage) ⇒ <code>Promise.&lt;string&gt;</code>
    * [.decryptMessage(encrypted)](#module_miot/Bluetooth--module.exports.IBluetoothLock+decryptMessage) ⇒ <code>Promise.&lt;string&gt;</code>

<a name="module_miot/Bluetooth--module.exports.IBluetoothLock+toggle"></a>

##### iBluetoothLock.toggle(cmd, timeout) ⇒ <code>Promise.&lt;IBluetoothLock&gt;</code>
支持小米加密芯片的蓝牙设备，开关蓝牙锁

**Kind**: instance method of [<code>IBluetoothLock</code>](#module_miot/Bluetooth--module.exports.IBluetoothLock)  

| Param | Type | Description |
| --- | --- | --- |
| cmd | <code>int</code> | 操作命令可传入 0 ，1 ，2三个 int 值，分别代表 开锁，上锁，反锁 |
| timeout | <code>int</code> | 毫秒 蓝牙未响应的超时时间 |

**Example**  
```js
import {Bluetooth} from 'miot'
...
Bluetooth.createBluetoothLE(...).connect(...).then(device => {
 device.securityLock().toggle(0,5000)
     .then(lock => {console.log('toggle success')})
     .catch(err => {console.log('toggle failed'})
})
...
```
<a name="module_miot/Bluetooth--module.exports.IBluetoothLock+isShareKeyValid"></a>

##### iBluetoothLock.isShareKeyValid() ⇒ <code>Promise.&lt;IBluetoothLock&gt;</code>
支持小米加密芯片的蓝牙设备，在被分享的设备中，调用此方法，可判断分享的电子钥匙是否有效

**Kind**: instance method of [<code>IBluetoothLock</code>](#module_miot/Bluetooth--module.exports.IBluetoothLock)  
**Example**  
```js
import {Bluetooth} from 'miot'
...
Bluetooth.createBluetoothLE(...).securityLock().isShareKeyValid()
 .then(lock => {console.log('ShareKey is valid')})
 .catch(err => {console.log('ShareKey isn't valid'})
...
```
<a name="module_miot/Bluetooth--module.exports.IBluetoothLock+getOneTimePassword"></a>

##### iBluetoothLock.getOneTimePassword(interval, digits) ⇒ <code>Promise.&lt;Array.&lt;int&gt;&gt;</code>
支持小米加密芯片的蓝牙设备，获取一次性密码组
假设输入 interval 为 30，则会从当日 0 点开始计算，每 30 分钟为一个刷新间隔。生成的密码在当前刷新间隔及下一个刷新间隔内有效。
如当日 10:19 生成，则该组密码在 10:00 ~ 10:30（当前刷新间隔） 以及 10:30 ~ 11:00 (下一个刷新间隔) 有效。
密码组中每条密码使用一次即过期。
注意设备上获取当前时间（UTC，精度为秒）的准确性由设备保证，否则会有计算误差。

**Kind**: instance method of [<code>IBluetoothLock</code>](#module_miot/Bluetooth--module.exports.IBluetoothLock)  

| Param | Type | Description |
| --- | --- | --- |
| interval | <code>int</code> | 时间间隔，单位为分钟，类型为 number，传入 10 到 60 的整数 |
| digits | <code>int</code> | 密码位数，类型为 number，传入 6 到 8 的整数 |

**Example**  
```js
import {Bluetooth} from 'miot'
...
Bluetooth.createBluetoothLE(...).securityLock().getOneTimePassword(30,6)
 .then(pwd => {console.log('one time password is ', pwd)})
 .catch(err => {console.log('get one time password failed, ', err})
...
```
<a name="module_miot/Bluetooth--module.exports.IBluetoothLock+encryptMessage"></a>

##### iBluetoothLock.encryptMessage(message) ⇒ <code>Promise.&lt;string&gt;</code>
支持小米加密芯片的蓝牙设备，使用此方法将明文加密为密文后，可发送给设备

**Kind**: instance method of [<code>IBluetoothLock</code>](#module_miot/Bluetooth--module.exports.IBluetoothLock)  

| Param | Type | Description |
| --- | --- | --- |
| message | <code>string</code> | 明文 |

**Example**  
```js
import {Bluetooth} from 'miot'
...
Bluetooth.createBluetoothLE(...).securityLock().encryptMessage('message')
 .then(msg => {console.log('encrypted message is ', msg)})
 .catch(err => {console.log('encrypted message failed, ', err})
...
```
<a name="module_miot/Bluetooth--module.exports.IBluetoothLock+decryptMessage"></a>

##### iBluetoothLock.decryptMessage(encrypted) ⇒ <code>Promise.&lt;string&gt;</code>
支持小米加密芯片的蓝牙设备，使用此方法将明文加密为密文后，可发送给设备

**Kind**: instance method of [<code>IBluetoothLock</code>](#module_miot/Bluetooth--module.exports.IBluetoothLock)  

| Param | Type | Description |
| --- | --- | --- |
| encrypted | <code>string</code> | 密文 |

**Example**  
```js
import {Bluetooth} from 'miot'
...
Bluetooth.createBluetoothLE(...).securityLock().encryptMessage('decryptedMessage')
 .then(msg => {console.log('decrypt message is ', msg)})
 .catch(err => {console.log('decrypt message failed, ', err})
...
```
<a name="module_miot/Bluetooth--module.exports.IBluetooth"></a>

#### module.exports.IBluetooth
**Kind**: static interface of [<code>module.exports</code>](#exp_module_miot/Bluetooth--module.exports)  

* [.IBluetooth](#module_miot/Bluetooth--module.exports.IBluetooth)
    * [.isBLE](#module_miot/Bluetooth--module.exports.IBluetooth+isBLE) : <code>boolean</code>
    * [.mac](#module_miot/Bluetooth--module.exports.IBluetooth+mac) : <code>string</code>
    * [.UUID](#module_miot/Bluetooth--module.exports.IBluetooth+UUID) : <code>string</code>
    * [.isConnected](#module_miot/Bluetooth--module.exports.IBluetooth+isConnected) : <code>boolean</code>
    * [.connect(type, option)](#module_miot/Bluetooth--module.exports.IBluetooth+connect) ⇒ <code>Promise.&lt;IBluetooth&gt;</code>
    * [.readRSSI()](#module_miot/Bluetooth--module.exports.IBluetooth+readRSSI) ⇒ <code>Promise.&lt;\*&gt;</code>
    * [.disconnect(delay)](#module_miot/Bluetooth--module.exports.IBluetooth+disconnect)
    * [.maximumWriteValueLength(type)](#module_miot/Bluetooth--module.exports.IBluetooth+maximumWriteValueLength)
    * [.getVersion()](#module_miot/Bluetooth--module.exports.IBluetooth+getVersion) ⇒ <code>Promise.&lt;any&gt;</code>

<a name="module_miot/Bluetooth--module.exports.IBluetooth+isBLE"></a>

##### iBluetooth.isBLE : <code>boolean</code>
是否 BLE 蓝牙

**Kind**: instance property of [<code>IBluetooth</code>](#module_miot/Bluetooth--module.exports.IBluetooth)  
**Read only**: true  
<a name="module_miot/Bluetooth--module.exports.IBluetooth+mac"></a>

##### iBluetooth.mac : <code>string</code>
蓝牙设备的 mac 地址

**Kind**: instance property of [<code>IBluetooth</code>](#module_miot/Bluetooth--module.exports.IBluetooth)  
**Read only**: true  
<a name="module_miot/Bluetooth--module.exports.IBluetooth+UUID"></a>

##### iBluetooth.UUID : <code>string</code>
蓝牙设备的 UUID

**Kind**: instance property of [<code>IBluetooth</code>](#module_miot/Bluetooth--module.exports.IBluetooth)  
**Read only**: true  
<a name="module_miot/Bluetooth--module.exports.IBluetooth+isConnected"></a>

##### iBluetooth.isConnected : <code>boolean</code>
蓝牙是否已经连接

**Kind**: instance property of [<code>IBluetooth</code>](#module_miot/Bluetooth--module.exports.IBluetooth)  
**Read only**: true  
<a name="module_miot/Bluetooth--module.exports.IBluetooth+connect"></a>

##### iBluetooth.connect(type, option) ⇒ <code>Promise.&lt;IBluetooth&gt;</code>
打开蓝牙链接. option参数peripheralID为iOS 平台的可选参数，因为iOS平台无法获取普通 BLE 蓝牙设备的 Mac
peripheralID 可通过 startScan（）搜索周边蓝牙设备获取（如设备OTA中，设备固件切换，无小米蓝牙协议相关服务时需建立连接），或通过retrievePeripheralsWithServicesForIOS（）搜索已连接设备获取（如可穿戴长连接设备，无法发送 mibeacon）
建立连接后，SDK 会用 peripheralID 充当 Mac 地址

**Kind**: instance method of [<code>IBluetooth</code>](#module_miot/Bluetooth--module.exports.IBluetooth)  

| Param | Type | Default | Description |
| --- | --- | --- | --- |
| type | <code>int</code> |  | 蓝牙设备类型 -1 自动判断，0 普通小米蓝牙协议设备，1 安全芯片小米蓝牙设备（比如锁类产品），2 分享的安全芯片小米蓝牙设备，3 普通的BLE蓝牙设备(无 mibeacon，无小米 FE95 service) |
| option | <code>json</code> | <code>0</code> | 附加参数, 格式 {timeout:12000, peripheralID:"..."}, timeout的单位为毫秒, peripheralID是iOS平台参数 |

**Example**  
```js
Device.getBluetoothLE()
      .connect(3, {peripheralID:"1-a-b-3-c", timeout:12000})
      .then(ble=>{
         ...
      })
      .catch(err=>{
         ...
      });
```
<a name="module_miot/Bluetooth--module.exports.IBluetooth+readRSSI"></a>

##### iBluetooth.readRSSI() ⇒ <code>Promise.&lt;\*&gt;</code>
读取 RSSI

**Kind**: instance method of [<code>IBluetooth</code>](#module_miot/Bluetooth--module.exports.IBluetooth)  
<a name="module_miot/Bluetooth--module.exports.IBluetooth+disconnect"></a>

##### iBluetooth.disconnect(delay)
关闭链接

**Kind**: instance method of [<code>IBluetooth</code>](#module_miot/Bluetooth--module.exports.IBluetooth)  

| Param | Type | Default | Description |
| --- | --- | --- | --- |
| delay | <code>int</code> | <code>0</code> | 延迟时长(毫秒) |

<a name="module_miot/Bluetooth--module.exports.IBluetooth+maximumWriteValueLength"></a>

##### iBluetooth.maximumWriteValueLength(type)
获取当前连接设备写操作每包最大长度
注：有开发者反馈该系统接口在 iOS 上并不完全准确，不可过于依赖，以实际测试为准
注：返回值单位为 bit，注意换算，8 bit 为 1 byte，两字符 hexString 长度为 1 byte，如 “FF”

**Kind**: instance method of [<code>IBluetooth</code>](#module_miot/Bluetooth--module.exports.IBluetooth)  

| Param | Type | Default | Description |
| --- | --- | --- | --- |
| type | <code>int</code> | <code>0</code> | 0 代表 writeWithResponse, 1 代表 writeWithoutResponse |

<a name="module_miot/Bluetooth--module.exports.IBluetooth+getVersion"></a>

##### iBluetooth.getVersion() ⇒ <code>Promise.&lt;any&gt;</code>
更新版本号，蓝牙的版本号 connect 之后才能

**Kind**: instance method of [<code>IBluetooth</code>](#module_miot/Bluetooth--module.exports.IBluetooth)  
<a name="module_miot/Bluetooth--module.exports.IBluetoothLE"></a>

#### module.exports.IBluetoothLE
**Kind**: static interface of [<code>module.exports</code>](#exp_module_miot/Bluetooth--module.exports)  

* [.IBluetoothLE](#module_miot/Bluetooth--module.exports.IBluetoothLE)
    * [.securityLock](#module_miot/Bluetooth--module.exports.IBluetoothLE+securityLock) ⇒ <code>IBluetoothLock</code>
    * [.getService](#module_miot/Bluetooth--module.exports.IBluetoothLE+getService) ⇒ <code>IBluetoothService</code>
    * [.startDiscoverServices(...serviceUUIDs)](#module_miot/Bluetooth--module.exports.IBluetoothLE+startDiscoverServices) ⇒ <code>boolean</code>
    * [.getVersion()](#module_miot/Bluetooth--module.exports.IBluetoothLE+getVersion) ⇒ <code>boolean</code>

<a name="module_miot/Bluetooth--module.exports.IBluetoothLE+securityLock"></a>

##### iBluetoothLE.securityLock ⇒ <code>IBluetoothLock</code>
蓝牙锁相关操作

**Kind**: instance property of [<code>IBluetoothLE</code>](#module_miot/Bluetooth--module.exports.IBluetoothLE)  
<a name="module_miot/Bluetooth--module.exports.IBluetoothLE+getService"></a>

##### iBluetoothLE.getService ⇒ <code>IBluetoothService</code>
获取蓝牙服务

**Kind**: instance property of [<code>IBluetoothLE</code>](#module_miot/Bluetooth--module.exports.IBluetoothLE)  

| Param | Type |
| --- | --- |
| serviceUUID | <code>string</code> | 

<a name="module_miot/Bluetooth--module.exports.IBluetoothLE+startDiscoverServices"></a>

##### iBluetoothLE.startDiscoverServices(...serviceUUIDs) ⇒ <code>boolean</code>
发现服务

**Kind**: instance method of [<code>IBluetoothLE</code>](#module_miot/Bluetooth--module.exports.IBluetoothLE)  

| Param | Type |
| --- | --- |
| ...serviceUUIDs | <code>string</code> | 

<a name="module_miot/Bluetooth--module.exports.IBluetoothLE+getVersion"></a>

##### iBluetoothLE.getVersion() ⇒ <code>boolean</code>
获取蓝牙固件版本

**Kind**: instance method of [<code>IBluetoothLE</code>](#module_miot/Bluetooth--module.exports.IBluetoothLE)  
<a name="module_miot/Bluetooth--module.exports.IBluetoothClassic"></a>

#### module.exports.IBluetoothClassic
**Kind**: static interface of [<code>module.exports</code>](#exp_module_miot/Bluetooth--module.exports)  
<a name="module_miot/Bluetooth--module.exports.UUID128"></a>

#### module.exports.UUID128 ⇒ <code>string</code>
标准化蓝牙UUID为128位大写

**Kind**: static property of [<code>module.exports</code>](#exp_module_miot/Bluetooth--module.exports)  

| Param | Type |
| --- | --- |
| id | <code>string</code> | 

**Example**  
```js
import {Bluetooth} from 'miot';
const myServiceUUID = Bluetooth.UUID128("0015");
const myCharacterUUID = Bluetooth.UUID128("f7255c06-e981-46f1-be3d-86c5cd1bb590");
```
<a name="module_miot/Bluetooth--module.exports.isSameUUID"></a>

#### module.exports.isSameUUID(uuid1, uuid2)
用以判断两个 UUID 是否相等

**Kind**: static method of [<code>module.exports</code>](#exp_module_miot/Bluetooth--module.exports)  

| Param | Type |
| --- | --- |
| uuid1 | <code>string</code> | 
| uuid2 | <code>string</code> | 

<a name="module_miot/Bluetooth--module.exports.createBluetoothLE"></a>

#### module.exports.createBluetoothLE(macOrPeripheralID) ⇒ <code>IBluetoothLE</code>
创建BLE蓝牙设备,

**Kind**: static method of [<code>module.exports</code>](#exp_module_miot/Bluetooth--module.exports)  

| Param | Type | Description |
| --- | --- | --- |
| macOrPeripheralID | <code>string</code> | - iOS传 peripheralUUID, android 传 mac |

**Example**  
```js
import Bluetooth from 'miot/Bluetooth'
  const ble = Bluetooth.createBluetoothLE("a.b.c...")
```
<a name="module_miot/Bluetooth--module.exports.createBluetoothClassic"></a>

#### module.exports.createBluetoothClassic(macOrPeripheralID) ⇒ <code>IBluetoothClassic</code>
创建经典蓝牙设备

**Kind**: static method of [<code>module.exports</code>](#exp_module_miot/Bluetooth--module.exports)  

| Param | Type | Description |
| --- | --- | --- |
| macOrPeripheralID | <code>string</code> | - iOS传 peripheralUUID, android 传 mac |

**Example**  
```js
import Bluetooth from 'miot/Bluetooth'
  const bludtoothClassic = Bluetooth.createBluetoothClassic("a.b.c...")
```
<a name="module_miot/Bluetooth--module.exports.checkBluetoothIsEnabled"></a>

#### module.exports.checkBluetoothIsEnabled() ⇒ <code>Promise.&lt;boolean&gt;</code>
判断蓝牙是否开放

**Kind**: static method of [<code>module.exports</code>](#exp_module_miot/Bluetooth--module.exports)  
<a name="module_miot/Bluetooth--module.exports.startScan"></a>

#### module.exports.startScan(durationInMillis, ...serviceUUIDs) ⇒ <code>void</code>
开始扫描蓝牙设备

**Kind**: static method of [<code>module.exports</code>](#exp_module_miot/Bluetooth--module.exports)  

| Param | Type | Description |
| --- | --- | --- |
| durationInMillis | <code>int</code> | 扫描时长 |
| ...serviceUUIDs | <code>string</code> | 指定扫描, 为空时扫描全部 |

**Example**  
```js
import Bluetooth from 'miot/Bluetooth'
     Bluetooth.startScan(3000, 'FE95','FE96')
```
<a name="module_miot/Bluetooth--module.exports.stopScan"></a>

#### module.exports.stopScan() ⇒ <code>void</code>
停止扫描蓝牙设备

**Kind**: static method of [<code>module.exports</code>](#exp_module_miot/Bluetooth--module.exports)  
<a name="module_miot/Bluetooth--module.exports.retrievePeripheralsForIOS"></a>

#### module.exports.retrievePeripheralsForIOS(...UUIDs) ⇒ <code>Promise.&lt;Map.&lt;uuid, Bluetooth&gt;&gt;</code>
iOS 平台获取已连接 BLE Peripheral，适用于可穿戴长连接设备
对应 coreBLuetooth 中 retrievePeripheralsWithIdentifiers:(NSArray<NSUUID *> *)identifiers 方法

**Kind**: static method of [<code>module.exports</code>](#exp_module_miot/Bluetooth--module.exports)  
**Returns**: <code>Promise.&lt;Map.&lt;uuid, Bluetooth&gt;&gt;</code> - //@mark ios done  

| Param | Type | Description |
| --- | --- | --- |
| ...UUIDs | <code>string</code> | Peripheral UUIDs |

**Example**  
```js
Bluetooth.retrievePeripheralsForIOS("PeripheralUUID1","PeripheralUUID2","PeripheralUUID3")
```
<a name="module_miot/Bluetooth--module.exports.retrievePeripheralsWithServicesForIOS"></a>

#### module.exports.retrievePeripheralsWithServicesForIOS(...serviceUUIDs) ⇒ <code>Promise.&lt;Map.&lt;uuid, Bluetooth&gt;&gt;</code>
iOS 平台通过 serviceUUID 获取已连接 BLE Peripheral，适用于可穿戴长连接设备
对应 coreBLuetooth 中 retrieveConnectedPeripheralsWithServices:(NSArray<CBUUID *> *)serviceUUIDs 方法

**Kind**: static method of [<code>module.exports</code>](#exp_module_miot/Bluetooth--module.exports)  
**Returns**: <code>Promise.&lt;Map.&lt;uuid, Bluetooth&gt;&gt;</code> - //@mark ios done  

| Param | Type | Description |
| --- | --- | --- |
| ...serviceUUIDs | <code>string</code> | Peripheral  serviceUUIDs |

**Example**  
```js
Bluetooth.retrievePeripheralsWithServicesForIOS("serviceUUID1","serviceUUID2","serviceUUID3")
```
<a name="module_miot/Bluetooth--module.exports.enableBluetoothForAndroid"></a>

#### module.exports.enableBluetoothForAndroid(silence) ⇒
打开蓝牙

**Kind**: static method of [<code>module.exports</code>](#exp_module_miot/Bluetooth--module.exports)  
**Returns**: void  

| Param | Type |
| --- | --- |
| silence | <code>boolean</code> | 

<a name="module_miot/Bluetooth--module.exports.isBleGatewayConnected"></a>

#### module.exports.isBleGatewayConnected(mac) ⇒ <code>Promise.&lt;boolean&gt;</code>
判断当前设备是否通过蓝牙网关扫描到了

**Kind**: static method of [<code>module.exports</code>](#exp_module_miot/Bluetooth--module.exports)  

| Param | Type |
| --- | --- |
| mac | <code>string</code> | 

<a name="module_miot/Bluetooth--module.exports.bindDeviceforMIUI"></a>

#### module.exports.bindDeviceforMIUI(mac)
只在MIUI上支持，维持长连接 如果连接失败，则会隔一段时间尝试重连，如果继续失败，则重连间隔会翻倍，直到上限。

**Kind**: static method of [<code>module.exports</code>](#exp_module_miot/Bluetooth--module.exports)  

| Param | Type |
| --- | --- |
| mac | <code>string</code> | 

<a name="module_miot/Bluetooth--module.exports.unBindDeviceforMIUI"></a>

#### module.exports.unBindDeviceforMIUI(mac)
只在MIUI上支持，解除长连接

**Kind**: static method of [<code>module.exports</code>](#exp_module_miot/Bluetooth--module.exports)  

| Param | Type |
| --- | --- |
| mac | <code>string</code> | 

<a name="module_miot/Bluetooth--module.exports.setAlertConfigsOnMIUI"></a>

#### module.exports.setAlertConfigsOnMIUI(alert, enable, mac)
只在MIUI上支持，维持长连接 如果连接失败，则会隔一段时间尝试重连，如果继续失败，则重连间隔会翻倍，直到上限。

**Kind**: static method of [<code>module.exports</code>](#exp_module_miot/Bluetooth--module.exports)  

| Param | Type |
| --- | --- |
| alert | <code>\*</code> | 
| enable | <code>\*</code> | 
| mac | <code>string</code> | 

<a name="module_miot/Bluetooth--module.exports..BluetoothEvent"></a>

#### module.exports~BluetoothEvent : <code>object</code>
蓝牙事件名集合

**Kind**: inner namespace of [<code>module.exports</code>](#exp_module_miot/Bluetooth--module.exports)  
**Example**  
```js
import {BluetoothEvent} from 'miot'
   const subscription = BluetoothEvent.bluetoothServiceDiscovered.addListener(
      (bluetooth, ...services)=>{
         ...
      }
    )
   ...
   subscription.remove()
   ...
```

* [~BluetoothEvent](#module_miot/Bluetooth--module.exports..BluetoothEvent) : <code>object</code>
    * ["bluetoothConnectionStatusChanged" (bluetooh, isConnected)](#module_miot/Bluetooth--module.exports..BluetoothEvent.event_bluetoothConnectionStatusChanged)
    * ["bluetoothDeviceDiscovered" (bluetoohData)](#module_miot/Bluetooth--module.exports..BluetoothEvent.event_bluetoothDeviceDiscovered)
    * ["bluetoothDeviceDiscoverFailed" (error)](#module_miot/Bluetooth--module.exports..BluetoothEvent.event_bluetoothDeviceDiscoverFailed)
    * ["bluetoothSeviceDiscovered" (bluetooh, ...service)](#module_miot/Bluetooth--module.exports..BluetoothEvent.event_bluetoothSeviceDiscovered)
    * ["bluetoothSeviceDiscoverFailed" (bluetooh, error)](#module_miot/Bluetooth--module.exports..BluetoothEvent.event_bluetoothSeviceDiscoverFailed)
    * ["bluetoothCharacteristicDiscovered" (bluetooh, service, ...characters)](#module_miot/Bluetooth--module.exports..BluetoothEvent.event_bluetoothCharacteristicDiscovered)
    * ["bluetoothCharacteristicDiscoverFailed" (bluetooh, service, error)](#module_miot/Bluetooth--module.exports..BluetoothEvent.event_bluetoothCharacteristicDiscoverFailed)
    * ["bluetoothCharacteristicValueChanged" (bluetooh, service, character, value)](#module_miot/Bluetooth--module.exports..BluetoothEvent.event_bluetoothCharacteristicValueChanged)
    * ["bluetoothStatusChanged" (isEnabled)](#module_miot/Bluetooth--module.exports..BluetoothEvent.event_bluetoothStatusChanged)

<a name="module_miot/Bluetooth--module.exports..BluetoothEvent.event_bluetoothConnectionStatusChanged"></a>

##### "bluetoothConnectionStatusChanged" (bluetooh, isConnected)
蓝牙断开连接

**Kind**: event emitted by [<code>BluetoothEvent</code>](#module_miot/Bluetooth--module.exports..BluetoothEvent)  

| Param | Type | Description |
| --- | --- | --- |
| bluetooh | <code>IBluetooth</code> | 发生连接打开关闭事件的蓝牙设备 |
| isConnected | <code>boolean</code> | 当前连接状态 |

<a name="module_miot/Bluetooth--module.exports..BluetoothEvent.event_bluetoothDeviceDiscovered"></a>

##### "bluetoothDeviceDiscovered" (bluetoohData)
蓝牙设备扫描发现事件

**Kind**: event emitted by [<code>BluetoothEvent</code>](#module_miot/Bluetooth--module.exports..BluetoothEvent)  

| Param | Type | Description |
| --- | --- | --- |
| bluetoohData | <code>json</code> | -扫描发现的蓝牙设备数据 |

<a name="module_miot/Bluetooth--module.exports..BluetoothEvent.event_bluetoothDeviceDiscoverFailed"></a>

##### "bluetoothDeviceDiscoverFailed" (error)
蓝牙设备扫描发现失败事件

**Kind**: event emitted by [<code>BluetoothEvent</code>](#module_miot/Bluetooth--module.exports..BluetoothEvent)  

| Param | Type | Description |
| --- | --- | --- |
| error | <code>\*</code> | 错误信息 |

<a name="module_miot/Bluetooth--module.exports..BluetoothEvent.event_bluetoothSeviceDiscovered"></a>

##### "bluetoothSeviceDiscovered" (bluetooh, ...service)
蓝牙服务发现事件

**Kind**: event emitted by [<code>BluetoothEvent</code>](#module_miot/Bluetooth--module.exports..BluetoothEvent)  

| Param | Type | Description |
| --- | --- | --- |
| bluetooh | <code>IBluetooth</code> | 蓝牙设备 |
| ...service | <code>IBluetoothService</code> | 发现的蓝牙服务 |

<a name="module_miot/Bluetooth--module.exports..BluetoothEvent.event_bluetoothSeviceDiscoverFailed"></a>

##### "bluetoothSeviceDiscoverFailed" (bluetooh, error)
蓝牙服务发现失败事件

**Kind**: event emitted by [<code>BluetoothEvent</code>](#module_miot/Bluetooth--module.exports..BluetoothEvent)  

| Param | Type | Description |
| --- | --- | --- |
| bluetooh | <code>IBluetooth</code> | 蓝牙设备 |
| error | <code>\*</code> | 错误信息 |

<a name="module_miot/Bluetooth--module.exports..BluetoothEvent.event_bluetoothCharacteristicDiscovered"></a>

##### "bluetoothCharacteristicDiscovered" (bluetooh, service, ...characters)
蓝牙特征发现事件

**Kind**: event emitted by [<code>BluetoothEvent</code>](#module_miot/Bluetooth--module.exports..BluetoothEvent)  

| Param | Type | Description |
| --- | --- | --- |
| bluetooh | <code>IBluetooth</code> | 蓝牙设备 |
| service | <code>IBluetoothService</code> | 蓝牙特征 |
| ...characters | <code>IBluetoothCharacteristic</code> | 发现的蓝牙特征 |

<a name="module_miot/Bluetooth--module.exports..BluetoothEvent.event_bluetoothCharacteristicDiscoverFailed"></a>

##### "bluetoothCharacteristicDiscoverFailed" (bluetooh, service, error)
蓝牙特征发现失败事件

**Kind**: event emitted by [<code>BluetoothEvent</code>](#module_miot/Bluetooth--module.exports..BluetoothEvent)  

| Param | Type | Description |
| --- | --- | --- |
| bluetooh | <code>IBluetooth</code> | 蓝牙设备 |
| service | <code>IBluetoothService</code> | 蓝牙特征 |
| error | <code>\*</code> | 错误信息 |

<a name="module_miot/Bluetooth--module.exports..BluetoothEvent.event_bluetoothCharacteristicValueChanged"></a>

##### "bluetoothCharacteristicValueChanged" (bluetooh, service, character, value)
蓝牙特征值变更事件
notify, read

**Kind**: event emitted by [<code>BluetoothEvent</code>](#module_miot/Bluetooth--module.exports..BluetoothEvent)  

| Param | Type | Description |
| --- | --- | --- |
| bluetooh | <code>IBluetooth</code> | 蓝牙设备 |
| service | <code>IBluetoothService</code> | 蓝牙服务 |
| character | <code>IBluetoothCharacteristic</code> | 蓝牙特征 |
| value | <code>\*</code> | 数值 |

<a name="module_miot/Bluetooth--module.exports..BluetoothEvent.event_bluetoothStatusChanged"></a>

##### "bluetoothStatusChanged" (isEnabled)
蓝牙开关状态变更事件

**Kind**: event emitted by [<code>BluetoothEvent</code>](#module_miot/Bluetooth--module.exports..BluetoothEvent)  

| Param | Type | Description |
| --- | --- | --- |
| isEnabled | <code>boolean</code> | 当前状态 |

